<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/static/img/favicon.ico" type="image/x-icon">
    <title>Azure OpenAI o1 Chat</title>
    
    <!-- Styles -->
    <link rel="stylesheet" href="/static/index.css">
    <link rel="stylesheet" href="/static/css/components.css">
    <link rel="stylesheet" href="/static/css/layout.css">

    <!-- Libraries -->
    <script src="/static/lib/markdown-it.min.js"></script>
    <script>
        // Configuration handled in config.js module
    </script>
    <script src="/static/lib/purify.min.js"></script>

    <!-- Favicon and touch icons -->
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/img/apple-touch-icon.png">
    <link rel="manifest" href="/static/site.webmanifest">

    <!-- Core Modules -->
    <script type="module" src="/static/js/session.js"></script>
    <script type="module" src="/static/js/config.js"></script>
    <script type="module" src="/static/js/utils/helpers.js"></script>
    <script type="module" src="/static/js/ui/markdownParser.js"></script>
    <script type="module" src="/static/js/ui/notificationManager.js"></script>
    <script type="module" src="/static/js/ui/displayManager.js"></script>
    <script type="module" src="/static/js/fileManager.js"></script>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <main class="chat-container">
        <header class="chat-header">
            <h1>Azure OpenAI o1 Chat</h1>
            <div class="model-info">
                <p><strong>Model Info:</strong> Using Azure OpenAI o1 model (no streaming)</p>
            </div>
            <!-- Add this after model-info -->
            <div class="performance-stats" id="performance-stats">
            <!-- Stats will be injected here -->
            </div>

            <!-- Theme toggle will be injected here by JavaScript -->
        </header>

        <div class="chat-main">
            <!-- Chat History -->
            <section class="chat-history" id="chat-history" role="log" aria-live="polite">
                <!-- Messages injected via JavaScript -->
            </section>

            <!-- Input Area -->
            <section class="input-section">
                <div class="input-container">
                    <textarea id="user-input" 
                              placeholder="Type your message..."
                              aria-label="Your message"
                              rows="1"></textarea>
                    <button id="send-button" class="primary-button">
                        <span aria-hidden="true">‚Üë</span>
                        <span class="sr-only">Send message</span>
                    </button>
                </div>
                
                <!-- Token Usage -->
                <div class="token-usage-compact active" aria-label="Token usage statistics">
                    <div class="token-usage-grid">
                        <div class="stat-item">
                            <span class="stat-label">Prompt</span>
                            <span id="prompt-tokens" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Completion</span>
                            <span id="completion-tokens" class="stat-value">0</span>
                        </div>
                        <div class="stat-item highlight">
                            <span class="stat-label">Total</span>
                            <span id="total-tokens" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Reasoning</span>
                            <span id="reasoning-tokens" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Base Completion</span>
                            <span id="base-completion-tokens" class="stat-value">0</span>
                        </div>
                    </div>
                    <!-- Token usage toggle will be injected here by JavaScript -->
                </div>
            </section>
        </div>

        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="tabs" role="tablist">
                <button class="tab-button active" 
                        id="config-tab"
                        role="tab" 
                        data-target-tab="config-content"
                        aria-selected="true"
                        aria-controls="config-content">
                    Configuration
                </button>
                <button class="tab-button"
                        id="files-tab"
                        data-target-tab="files-content"
                        role="tab"
                        aria-selected="false"
                        aria-controls="files-content">
                    Files &amp; Context
                </button>
            </div>

            <!-- Configuration Panel -->
            <div id="config-content" class="tab-content active" role="tabpanel">
                <div class="config-section">
                    <label for="model-selector">AI Model:</label>
                    <select id="model-selector" class="config-select">
                        <option value="deepseek-r1" selected>DeepSeek-R1 (General Purpose)</option>
                        <option value="o1">Azure o1 (Advanced Reasoning)</option>
                    </select>
                </div>

                <div class="config-section">
                    <label for="developer-config">Assistant Settings:</label>
                    <input type="text" 
                           id="developer-config"
                           value="Formatting re-enabled - use markdown code blocks"
                           aria-describedby="config-help">
                    <p id="config-help" class="help-text">
                        Customize the assistant's response format
                    </p>
                </div>

                <div class="config-section" id="reasoning-controls">
                    <label for="reasoning-effort-slider">
                        Reasoning Effort: 
                        <span id="reasoning-effort-display">Medium</span>
                    </label>
                    <input type="range" 
                           id="reasoning-effort-slider"
                           min="1" 
                           max="3" 
                           value="2"
                           aria-valuetext="Medium">
                    <div class="effort-description">
                        <p id="effort-description-text">
                            Medium: Balanced processing time (1-3min) and quality
                        </p>
                    </div>
                </div>

                <div class="config-section stream-toggle">
                    <label>
                        <input type="checkbox" id="enable-streaming"> Enable Streaming
                    </label>
                </div>
            </div>

            <!-- Files Panel -->
            <div id="files-content" class="tab-content" role="tabpanel" aria-hidden="true">
                <div class="files-panel">
                    <div class="file-actions">
                        <button class="upload-button">
                            <span class="folder-icon">üìÅ</span>
                            Upload Files
                        </button>
                        <div class="search-toggle">
                            <input type="checkbox" id="azure-search" class="toggle-input">
                            <label for="azure-search">Azure Search</label>
                        </div>
                    </div>

                    <div class="file-stats">
                        <span>Files: <span id="total-files">0</span></span>
                        <span>Size: <span id="total-size">0 B</span></span>
                        <span>Tokens: <span id="estimated-tokens">0</span></span>
                    </div>

                    <div class="file-drop-area">
                        <p class="drop-message">No files uploaded.</p>
                        <p class="drop-hint">Drop files above to add context.</p>
                    </div>

                    <input type="file" 
                           id="file-input" 
                           accept=".txt,.md,.json,.js,.py,.html,.css,.pdf,.docx,.doc" 
                           multiple 
                           hidden>
                </div>
            </div>
        </aside>

        <!-- Mobile Tab Toggle -->
        <button class="mobile-tab-toggle" aria-label="Open context panel">
            <span class="tab-icon">üìÅ</span>
        </button>
    </main>

    <!-- Error Display -->
    <div id="error-display" class="error-message"></div>

    <!-- Initialization -->
    <script type="module" src="/static/js/main.js"></script>
</body>
</html>
