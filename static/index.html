<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure OpenAI o1 Chat</title>
    
    <!-- Fonts and Styles -->
    <link rel="stylesheet" href="/static/fonts.css">
    <link rel="stylesheet" href="/static/index.css">
    <link rel="stylesheet" href="/static/lib/prism.min.css">

    <!-- Scripts -->
    <script src="/static/lib/markdown-it.min.js"></script>
    <script src="/static/lib/prism.min.js"></script>
    <script src="/static/lib/marked.min.js"></script>
    <!-- Add missing Font Awesome webfonts path -->
</head>
<body>
    <div class="container">
        <h1>Azure OpenAI o1 Chat</h1>
        
        <div class="developer-config">
            <label for="developer-config">Assistant Configuration:</label>
            <input type="text" id="developer-config"
                   value="Formatting re-enabled - please enclose code blocks with appropriate markdown tags"
                   placeholder="Custom configuration for the assistant">
            
            <div class="effort-slider">
                <label>Reasoning Effort: <span id="effort-display">Medium</span></label>
                <input type="range" id="reasoning-effort-slider"
                       min="0" max="2" value="1"
                       list="effort-ticks">
                <datalist id="effort-ticks">
                    <option value="0" label="Low"></option>
                    <option value="1" label="Medium"></option>
                    <option value="2" label="High"></option>
                </datalist>
                <div class="effort-description">
                    <small id="effort-description-text">
                        Medium: Balanced processing time (1-3min) and quality. Suitable for most queries.
                    </small>
                </div>
            </div>
        </div>

        <div class="model-info">
            <p><strong>Model Info:</strong> Using Azure OpenAI o1 model (no streaming, uses max_completion_tokens)</p>
        </div>

        <div class="chat-container">
            <div id="chat-history"></div>
            
            <div class="input-container">
                <textarea id="user-input" placeholder="Type your message..."></textarea>
                <button id="send-button">Send</button>
                <button onclick="regenerateResponse()" class="secondary">Regenerate</button>
                <div class="effort-tooltip">Reasoning effort only applies to o1 and o3-mini models.
                Higher effort may produce better results but takes longer.</div>
            </div>
        </div>

        <div class="stats-panel">
            <div class="tabs">
                <button class="tab-button active" 
                        onclick="switchTab('token-stats')" 
                        role="tab" 
                        aria-selected="true" 
                        aria-controls="token-stats"
                        data-target-tab="token-stats">Token Usage</button>
                <button class="tab-button" 
                        onclick="switchTab('file-stats')" 
                        role="tab" 
                        aria-selected="false" 
                        aria-controls="file-stats" 
                        id="file-stats-tab" 
                        data-target-tab="file-stats"
                        aria-label="Files and Context">Files &amp; Context</button>
            </div>
            
            <div id="token-stats" class="tab-content active">
                <h3>Token Usage Statistics</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-label">Prompt Tokens</div>
                        <div class="stat-value" id="prompt-tokens">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Completion Tokens</div>
                        <div class="stat-value" id="completion-tokens">0</div>
                    </div>
                    <div class="stat-item highlight">
                        <div class="stat-label">Total Tokens</div>
                        <div class="stat-value" id="total-tokens">0</div>
                    </div>
                </div>
            </div>
            
            <div id="file-stats" class="tab-content">
                <h3>Uploaded Files</h3>
                <div class="file-upload-area" id="drop-zone">
                    <div class="upload-prompt">
                        <i class="upload-icon">üìÅ</i>
                        <p>Drag and drop files here or click to select files<br>
                           <span class="file-limit" role="note">(Maximum 512MB per file, common text formats supported)</span>
                        </p>
                        <input type="file" 
                               id="file-input" 
                               accept=".txt,.text,text/*" 
                               multiple 
                               hidden 
                               aria-label="File upload input">
                    </div>
                </div>
                
                <div class="file-list" id="file-list">
                    <!-- Files will be listed here -->
                </div>
                
                <div class="file-stats">
                    <h4>Context Statistics</h4>
                    <p>Total Files: <span id="total-files">0</span></p>
                    <p>Total Characters: <span id="total-chars">0</span></p>
                    <p>Estimated Tokens: <span id="estimated-tokens">0</span></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts (at the end of body) -->
    <script src="/static/chat.js"></script>
</body>
</html>
